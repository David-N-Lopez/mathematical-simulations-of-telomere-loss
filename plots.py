from sim_with_cells import simulation_with_cells as sm
from cell_class import cell
from helix_class import chromosome_matrix as cm
import matplotlib.pyplot as plt
import math
import random
import math

plt.style.use('seaborn-whitegrid')
M=8
Kr = 0.1
alpha = 0.0009
base_pairs = 4000
p = 0.005

# fig = plt.figure()
#M =0
M0 = [2.686234307848047, 2.9717290557620974, 3.264206058050564, 3.513951815792515, 3.7887809292829444, 4.05995435991999, 4.3136308238009535, 4.5885752998786185, 4.83842467519734, 5.1199306288611455, 5.380078165880651, 5.642991974633039, 5.916085235282389, 6.172458332878276, 6.411733096755406, 6.6556225790916015, 6.920750357219511, 7.150007234136905, 7.408661030613785, 7.649730379274713, 7.870906497609905, 8.153964635947165, 8.34509393669592, 8.587626626040397, 8.787720097120351, 9.025629799805884, 9.265139986036592, 9.507525245891472, 9.72331050019564, 9.94954780504452, 10.156045451866664, 10.411244361798193, 10.634222297449995, 10.84053192162598, 11.01852216567271, 11.279855345435362, 11.460460139765797, 11.638328417893558, 11.853265337950733, 12.029491398219996, 12.214537499928603, 12.474387117504532, 12.559287213882026, 12.768210986597374, 12.950852350811457, 13.125473557162229, 13.316475935582096, 13.465382313149206, 13.572852826272316, 13.7146101308809, 13.928933811359567, 14.044895653026375, 14.141285286086548, 14.287513234288964, 14.459425710604028, 14.578976013642153, 14.705187928967929, 14.784612952473156, 14.958488782388084, 15.144985204369553, 15.256886720485099, 15.388967521932335, 15.510654487592824, 15.622020496160056, 15.782227084326152, 15.903115599463463, 15.924432783216652, 16.072322287846227, 16.2396203581162, 16.326847288717044, 16.401064406652683, 16.473174243827753, 16.540333513726335, 16.531467929400158, 16.677258750621956, 16.71222003748641, 16.817408650536503, 16.808024086493102, 16.791506896110622, 16.899201451689592, 17.00041023722183, 16.96019645557402, 17.042381066981815, 17.165914525218923, 17.184105157363188, 17.17718103706611, 17.164439724666952, 17.155362746700508, 17.17527329290023, 17.19758081207441, 17.159828772606375, 17.223909750796757, 17.203342722126965, 17.25176620453214, 17.19270227322893, 17.26513016609012, 17.239101971864248, 17.21279961744588, 17.21279961744588, 17.221745237157286, 17.15487222557525, 17.17995393381421, 17.15487222557525, 17.075794247743996, 17.063223341690122, 17.01611744001989, 16.874514819245174, 16.86455349993807, 16.749904223553056, 16.787583431682997, 16.843918051653407, 16.646716737115618, 16.646716737115618, 16.48775480464652, 16.379295342432716, 16.18911762209843, 15.842860086497073, 15.72143792361161, 15.937646405875274, 15.72143792361161, 15.271468914935562, 15.72143792361161, 15.271468914935562, 15.271468914935562, 15.271468914935562, 14.230076229777337]
M2 = [2.6836161417200772, 2.9691038340282954, 3.270268372472814, 3.535495614506012, 3.7829549625054915, 4.06879933802769, 4.3543944080445085, 4.621064125069638, 4.884011003102715, 5.129161674497455, 5.420797056689424, 5.693776288189732, 5.952089041054359, 6.1981330128882295, 6.442125818904643, 6.688003952263318, 6.9464151166196295, 7.182487162364251, 7.469606008078062, 7.677556867466998, 7.922599972724472, 8.15667686223357, 8.438638772527524, 8.648134371070704, 8.922568358010064, 9.122670751585416, 9.355989295130431, 9.587235819087168, 9.824584580390027, 10.04025886388462, 10.284943810852479, 10.497687222516214, 10.690216317827534, 10.943951264100116, 11.124792650282334, 11.34960427577458, 11.560364763628963, 11.75280238168541, 11.938533455971346, 12.152168092313586, 12.368671543602218, 12.50763687514337, 12.711543918938832, 12.93286636426332, 13.108467316574874, 13.335603547410415, 13.538023745188445, 13.689273849342099, 13.88594342990165, 14.056106005583038, 14.213593927287715, 14.413733284523836, 14.558289891903184, 14.731673948581879, 14.864215118379196, 15.018018658130835, 15.129186080847928, 15.303598417965398, 15.523743600320817, 15.70075539480508, 15.765757370280351, 15.907524361279238, 16.1057339323114, 16.161217470042626, 16.332793393798838, 16.432054585103092, 16.54463850167102, 16.69533629523208, 16.81950667786725, 17.00337760569381, 17.064740726104787, 17.265738590459993, 17.335156276802877, 17.46133761432696, 17.585011901501474, 17.70311121357947, 17.809607132904663, 17.90093802480396, 18.06425452254556, 18.142742577008427, 18.16979616316037, 18.30701471656675, 18.468639362171306, 18.473496264419662, 18.60506874562664, 18.65235502680005, 18.768348985644472, 18.84398601107389, 18.84371159173251, 18.993019572623496, 19.037609129557723, 19.17011694017721, 19.251444695534953, 19.366609139744554, 19.42180799494203, 19.48298447210286, 19.590321349258126, 19.537333225698507, 19.63634983302029, 19.643151418038197, 19.647266328113474, 19.77667424261799, 19.84700077289998, 19.916717907895748, 19.93667932747151, 19.98617004192159, 19.997567009542696, 20.06918122295053, 20.13122799092745, 20.1402518999326, 20.202578996363705, 20.297985593595186, 20.303375131942772, 20.205607864497555, 20.22427000446197, 20.2288128751931, 20.341404614906946, 20.271998298657103, 20.25391891470441, 20.16738366932811, 20.199930315061266, 20.132198892006922, 20.144246668235017, 20.087187320795973, 20.107051811446148, 20.107051811446148, 20.087187320795973, 20.119807338651352, 20.100530750762797, 20.073420891453736, 19.904611387112823, 19.883473663897338, 19.87250604867302, 19.758895786870998, 19.713298582151562, 19.662346333852025, 19.363114661593606, 19.325652270063813, 19.188814310155806, 19.284650665059797, 19.188814310155806, 19.065659126287922, 18.89311314799689, 19.13158763999623, 18.98789946737509, 18.771690985111427, 18.32172197643538, 18.32172197643538, 17.280329291277155]
M4 = [2.6897114522858985, 2.9655480257728546, 3.233202270910367, 3.5223340049871923, 3.783621169077597, 4.06022656541016, 4.310219225715461, 4.578672870028478, 4.852677556997449, 5.115599358638447, 5.377590118197657, 5.6469571056063, 5.922813008003586, 6.194000939303855, 6.418112756272644, 6.692666202167831, 6.908390773261966, 7.170055996272462, 7.454845759565333, 7.71302899198674, 7.939495948854903, 8.193287262555899, 8.425420844680513, 8.689940149037765, 8.86920191595729, 9.152017311697309, 9.34984597286093, 9.603425546064686, 9.841512374153531, 10.062645648014723, 10.256476988993102, 10.475714456603457, 10.69484034788434, 10.92447508570499, 11.177284075207798, 11.300674272118805, 11.578948239594665, 11.74167924114386, 11.94319703234134, 12.132537405808518, 12.351484106520076, 12.589469214318317, 12.755196012050845, 12.94451170444344, 13.113103685846855, 13.331018204440703, 13.516319443564873, 13.701184204597736, 13.900127393650244, 14.002134707884396, 14.173665186522541, 14.312535888781401, 14.516179346918298, 14.715732418163721, 14.868816947298473, 15.02953169299935, 15.207293260078112, 15.348308121142185, 15.499178850578279, 15.624889462321221, 15.738813875101199, 15.895548431848358, 15.981943512816251, 16.1661128796016, 16.306876176315537, 16.43171582649708, 16.61719394100065, 16.728361363717745, 16.80837291098, 16.91167726670469, 17.01129317308867, 17.11153105755059, 17.249219464801108, 17.324891432564872, 17.42898744099754, 17.583024087422512, 17.674382968159346, 17.787281086551534, 17.77538108380577, 17.85131849076743, 17.950722415995624, 17.91941832186803, 17.98286296230723, 18.02000291779388, 18.141270675153276, 18.21590429345018, 18.192680459861812, 18.321651455622423, 18.350685406889056, 18.316372866324272, 18.251496853352304, 18.287298327961963, 18.27421617975091, 18.29157291445787, 18.302539220313445, 18.352250129182885, 18.342232120593778, 18.413528788754128, 18.374151724684985, 18.425280615273735, 18.406406744623386, 18.347872870318934, 18.30749123645931, 18.25706545629773, 18.245017680069637, 18.238866097306527, 18.238866097306527, 18.134299678191656, 18.092985805207114, 17.996292451960052, 17.89965311174474, 17.912976073115587, 17.792821800820906, 17.73754035302498, 17.69634413676036, 17.626144189732024, 17.650826654209055, 17.352189471660964, 17.244406428058944, 17.30163309821852, 17.244406428058944, 17.178477914350637, 16.71536737407379, 17.005931936059604, 16.434540764498095, 16.71536737407379, 16.71536737407379, 16.71536737407379, 15.39314807933987]
M6 = [2.6748367511583133, 2.9532490315893636, 3.239631517389633, 3.5162530216717522, 3.801767488797158, 4.086374442762539, 4.341315049889457, 4.607010068297905, 4.886421945639828, 5.140137701158758, 5.40675887658472, 5.659291629907747, 5.9390704135216055, 6.175542716761502, 6.420465306320168, 6.7071610546145095, 6.93017371533388, 7.184791890673053, 7.450713119735878, 7.747823843444774, 7.939639500092008, 8.196670976402006, 8.455050651638924, 8.653839198246766, 8.912367067560863, 9.161359029091315, 9.417090679535505, 9.597189885473014, 9.829795258696302, 10.07951342780563, 10.273467939969054, 10.492694668537439, 10.720175163439528, 10.94032412817799, 11.149935324582481, 11.350896937315431, 11.54754856507356, 11.774879733404859, 11.94944913424595, 12.165386503882852, 12.32859481069149, 12.549180389774204, 12.727984991787674, 12.979187617005921, 13.149655575610051, 13.291391623368659, 13.476675470306105, 13.667477958893885, 13.880380438577522, 14.019099946138084, 14.214574755556125, 14.377596226832551, 14.529646031250303, 14.679526020892794, 14.88799249620834, 15.052367306074759, 15.170655605069586, 15.311860212542419, 15.561977889740795, 15.682453573431397, 15.815648060135407, 15.980087199709523, 16.09544867287282, 16.233420864337948, 16.373570713211645, 16.477623054302665, 16.530314522472256, 16.66275425648274, 16.757646910615474, 16.853357597436137, 16.99108781544132, 17.058829245952246, 17.128047586388924, 17.155101678864494, 17.215786953987497, 17.298555741018003, 17.352268163173644, 17.473655542929148, 17.49859714725981, 17.620931292311568, 17.637868017146523, 17.792227511069758, 17.75318691765021, 17.858454424215424, 17.84456752876743, 17.957719153269235, 17.988168050517015, 17.938342406580112, 18.021361484394102, 17.989452673452757, 18.030524347637076, 18.063406277140754, 18.016024786912716, 18.12624313262228, 18.080018624425524, 18.122569597707972, 18.11640888915577, 18.167535584569638, 18.165990738859247, 18.1452270101143, 18.132274922512668, 18.123420497935395, 18.071204419481045, 18.060997263825303, 18.090926059006453, 18.090926059006453, 18.086078972064264, 18.023255646078347, 18.050544425146832, 18.050544425146832, 18.034377751525067, 18.023255646078347, 18.00011864498525, 17.962923788196385, 17.922242478269943, 17.86129578910886, 17.853038991326915, 17.78063985749523, 17.79990219341704, 17.79990219341704, 17.642706300432263, 17.65602926180311, 17.53587498950843, 17.253472563683154, 17.369197378419546, 17.369197378419546, 17.253472563683154, 17.43939732544788, 17.343027144059242, 17.095242660348486, 16.748985124747126, 16.92153110303816, 17.095242660348486, 16.92153110303816, 16.843771444125327, 16.92153110303816, 16.92153110303816, 16.843771444125327, 16.177593953185617, 16.177593953185617, 15.13620126802739]
M8 = [2.680989168823562, 2.974350731269529, 3.2554538510575446, 3.504961853888325, 3.7807363268442873, 4.06280232925569, 4.3202839737495635, 4.585971134683484, 4.880723046080978, 5.12151936962643, 5.377905855390216, 5.649257939978973, 5.887634529281577, 6.13927361104153, 6.392883484264989, 6.655938111062309, 6.913279136768412, 7.1677155127922285, 7.404720560722994, 7.6642263579484196, 7.915957605263442, 8.107777055321595, 8.377072667427816, 8.647306205343641, 8.893155503649595, 9.136065210207082, 9.37898112560033, 9.6071033760161, 9.824035788016587, 10.035661540922941, 10.284681322484364, 10.493328383335943, 10.716610348537658, 10.915577674440302, 11.116694094425227, 11.294431688056209, 11.558438210121151, 11.735287408615076, 11.9680644016789, 12.190549439490058, 12.349435139666818, 12.535587724730396, 12.77277586786059, 12.914401602918458, 13.087926077813337, 13.246218022941695, 13.438146453439188, 13.589301912102668, 13.823553483171219, 13.980373010590434, 14.126973997365205, 14.326045501079726, 14.485292317652986, 14.605450652459474, 14.778472456304298, 14.926318502337013, 15.123582619566873, 15.269661521515362, 15.40665228902563, 15.583689042445133, 15.719491589017464, 15.847957885652642, 16.01843974870749, 16.11491139897672, 16.194729606031935, 16.352939898258512, 16.498545223791883, 16.63246396539556, 16.708362353170706, 16.823557786602617, 16.870000080461985, 16.974742441102364, 17.08792416632599, 17.139966797734346, 17.233846533753535, 17.305907290784912, 17.389808083828832, 17.52547211823744, 17.6415159132533, 17.71422707783572, 17.781093372844893, 17.884653178592743, 17.809224043680377, 17.933164325928946, 17.9668869617672, 17.935509306466187, 18.033950808451706, 18.065584584556046, 18.110017649832088, 18.153688600836897, 18.37238000172284, 18.413679568608053, 18.466599568347565, 18.56878120581049, 18.565390257258866, 18.59695345687882, 18.64265560242748, 18.64634025613129, 18.69531347987218, 18.65552022039416, 18.79575876682752, 18.848843698391562, 18.94837466318057, 18.98217461472351, 19.076906131607142, 19.045291553179776, 18.99175959507008, 19.058240016735702, 19.061920520157123, 19.123656497496082, 19.106929929690146, 19.09470695176508, 19.09055496524737, 19.102199360289557, 19.05466449332563, 19.07255763087349, 19.006413536472802, 19.05466449332563, 19.036002353361216, 19.068152983768165, 19.06370320629622, 19.02636168042509, 19.050073599815473, 19.00127997218613, 19.05466449332563, 19.016502131395878, 19.006413536472802, 18.98550483059937, 19.03120876736728, 18.95786863315879, 18.934419241107644, 18.99608500017233, 18.940401353346076, 18.896685435873856, 18.89006496495641, 18.869575576564795, 18.86252518663077, 18.758629052762046, 18.730660518266177, 18.690325798264286, 18.657408952063836, 18.55505047198206, 18.596311970163935, 18.710961246548948, 18.58298900879309, 18.645857886003263, 18.50945326726262, 18.55505047198206, 18.493124483726497, 18.357517343635944, 18.44009595628036, 18.159269346704665, 18.3341625512574, 18.19375527204398, 18.159269346704665, 18.225703089043595, 18.03552536870931, 17.984968995266865, 17.927742325107292, 17.927742325107292, 18.121806955174872, 17.984968995266865, 17.86181381139898, 17.784054152486153, 17.86181381139898, 17.11787666154644, 17.398703271122134, 17.398703271122134, 17.11787666154644, 17.11787666154644, 16.076483976388218]
M10 = [2.6931747324570003, 2.97431718856764, 3.262433611989122, 3.543511131804501, 3.8156540268326617, 4.081404143160357, 4.356211216087357, 4.637345754029919, 4.898484636826096, 5.152081503773033, 5.405631196087142, 5.677961993083458, 5.950141910637181, 6.2092782910351625, 6.478761838510963, 6.707577371975207, 6.9485963137442495, 7.21953443111674, 7.485348273848677, 7.7119496029041015, 7.916927374671488, 8.168356757044048, 8.36876315507398, 8.631680606414454, 8.883632438171801, 9.074874605711083, 9.33796885360496, 9.582050767920824, 9.795817571589607, 9.976551992811958, 10.259113251211902, 10.479781588024883, 10.643938049910243, 10.901036242609754, 11.122205876400622, 11.36096483554374, 11.558664912055484, 11.789639324660206, 11.9556860109297, 12.165062824129398, 12.334884880305284, 12.578710483228923, 12.752169418550647, 12.95610639088454, 13.109830416356123, 13.302051149546894, 13.509577992543964, 13.631439115057564, 13.83230676628297, 13.953679138995385, 14.178278439977186, 14.305940293958793, 14.449252640499838, 14.645494991991178, 14.777806415715784, 14.907372583431597, 15.01929118324772, 15.21676796899274, 15.42504719884495, 15.526522064249605, 15.701647615994657, 15.840328234985586, 15.986417097904102, 16.01945331252381, 16.155513605195544, 16.29177546876206, 16.4628727565733, 16.585082803994244, 16.688511958762835, 16.719170469044748, 16.78142623739962, 16.928575382908075, 17.079042263167644, 17.22233713063279, 17.25732131024619, 17.337327910256846, 17.491151696700975, 17.595222387574463, 17.64944806679832, 17.762256431946824, 17.7592163312344, 17.895800961311355, 18.034896417996283, 18.04557471120276, 18.059938452113677, 18.249330781628554, 18.315033672637583, 18.362921230912956, 18.384557039993318, 18.506595701386598, 18.499998623151466, 18.595746826767492, 18.629644120488862, 18.701015780721253, 18.71265571145793, 18.755437566661833, 18.784948164170373, 18.798002203779223, 18.80020156476154, 18.94751302082202, 18.951746160219027, 18.94300998712152, 18.91132021702635, 18.89342707947849, 18.884196243522418, 18.874764939514073, 18.796631219311646, 18.840042558338986, 18.840042558338986, 18.824267416752228, 18.88883618596833, 18.884196243522418, 18.897969950209617, 18.88883618596833, 18.915680640020394, 18.834847586325186, 18.845176122625663, 18.796631219311646, 18.748393674453858, 18.824267416752228, 18.796631219311646, 18.850249713994728, 18.785064770520403, 18.79088649954524, 18.76711616327084, 18.75472460991527, 18.741969082710067, 18.741969082710067, 18.728827551109266, 18.735448022026713, 18.68683404342233, 18.656398161392858, 18.701287772783626, 18.606328054664043, 18.64034108362254, 18.597391638914907, 18.518390935161257, 18.529088384417143, 18.4605536790069, 18.48462047215612, 18.50742331993694, 18.27885854243322, 18.331887069879354, 18.29726360511594, 18.29726360511594, 18.27885854243322, 18.094223509834244, 18.14824267293323, 17.998031932857522, 17.700576397551842, 17.960569541327732, 17.82373158141972, 17.960569541327732, 17.76650491126015, 17.62281673863901, 17.52803041926081, 15.915246562541073]

pltRange = list(range(len(M10)+40))

# plt.subplot(2,1,1)
# plt.title("M = {} Kr = {} alpha {}  p = {}".format(M,Kr, alpha, p))
# plt.ylabel("attempts")
plt.title("Attempts:  Kr = {} alpha {}  p = {}".format(Kr, alpha, p))
plt.scatter(list(range(len(M0))),M0, color = 'g',marker = '.', label = 'M0')
plt.scatter(list(range(len(M2))),M2, color = 'b',marker = '.', label = 'M2')
plt.scatter(list(range(len(M4))),M4, color = 'k',marker = '.', label = 'M4')
plt.scatter(list(range(len(M6))),M6, color = 'y',marker = '.', label = 'M6')
plt.scatter(list(range(len(M8))),M8, color = 'r',marker = '.', label = 'M8')
plt.scatter(list(range(len(M10))),M10, color = 'c',marker = '.', label = 'M10')
plt.legend(loc=2)

# plt.subplot(2,1,2)
# plt.ylabel("PDS")
# plt.plot(population_doublings, population)

plt.show()
